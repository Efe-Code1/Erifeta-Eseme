<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Physics</title>
    <style>
        body * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            background-color: black;
        }

        div {
            border: 1px solid black;
            width: 50px;
            height: 50px;
            position: absolute;
            left: 0;
            background-color: orange;
        }
    </style>
</head>

<body>
    <div></div>
    <script>
        let div1 = document.getElementsByTagName('div')[0]

        let moveAnimation

        let speedX = 90
        let positionX = 0
        let monitorX = 0

        let speedY = -50
        let positionY = 0
        let monitorY = 0

        let energyKept = 60 //%

        window.onload = () => {
            setTimeout(() => {
                moveAnimation = setInterval(() => {
                    div1.style.left = positionX + 'px'
                    div1.style.top = positionY + 'px'
                    positionX += speedX
                    if (positionX >= (parseInt(window.innerWidth) - parseInt(window.getComputedStyle(div1).getPropertyValue('width')))) {
                        positionX = (parseInt(window.innerWidth) - parseInt(window.getComputedStyle(div1).getPropertyValue('width')))
                        speedX *= -1 * (energyKept / 100)
                        speedX = parseFloat(speedX.toFixed(2))
                        div1.style.backgroundColor = `rgba(${random(0, 255)}, ${random(0, 255)}, ${random(0, 255)}, ${random2(0, 1)})`
                        div1.style.border = `5px solid rgba(${random(0, 255)}, ${random(0, 255)}, ${random(0, 255)}, ${random2(0, 1)})`
                    } else if (positionX < 0) {
                        positionX = 0
                        speedX *= -1 * (energyKept / 100)
                        speedX = parseFloat(speedX.toFixed(2))
                        div1.style.backgroundColor = `rgba(${random(0, 255)}, ${random(0, 255)}, ${random(0, 255)}, ${random2(0, 1)})`
                        div1.style.border = `5px solid rgba(${random(0, 255)}, ${random(0, 255)}, ${random(0, 255)}, ${random2(0, 1)})`
                    }
                    if((speedX < 1 && speedX > 0) || (speedX > -1 && speedX < 0) && monitorX == 0){
                        startB()
                        monitorX += 1
                    }

                    positionY += speedY
                    if (positionY >= (parseInt(window.innerHeight) - parseInt(window.getComputedStyle(div1).getPropertyValue('width')))) {
                        positionY = (parseInt(window.innerHeight) - parseInt(window.getComputedStyle(div1).getPropertyValue('width')))
                        speedY *= -1 * (energyKept / 100)
                        speedY = parseFloat(speedY.toFixed(2))
                        div1.style.backgroundColor = `rgba(${random(0, 255)}, ${random(0, 255)}, ${random(0, 255)}, ${random2(0, 1)})`
                        div1.style.border = `5px solid rgba(${random(0, 255)}, ${random(0, 255)}, ${random(0, 255)}, ${random2(0, 1)})`
                    } else if (positionY < 0) {
                        positionY = 0
                        speedY *= -1 * (energyKept / 100)
                        speedY = parseFloat(speedY.toFixed(2))
                        div1.style.backgroundColor = `rgba(${random(0, 255)}, ${random(0, 255)}, ${random(0, 255)}, ${random2(0, 1)})`
                        div1.style.border = `5px solid rgba(${random(0, 255)}, ${random(0, 255)}, ${random(0, 255)}, ${random2(0, 1)})`
                    }
                    if ((speedY < 1 && speedY > 0) || (speedY > -1 && speedY < 0) && monitorY == 0) {
                        startB()
                        monitorY += 1
                    }

                    if(speedX == 0 && speedY == 0){
                        clearInterval(moveAnimation)
                    }


                }, 16.667)
            }, 1000)
        }

        function startB(){
            let slowToHalt = setInterval(() => {
                if (speedX < 1 && speedX > 0) {
                    speedX -= 0.01
                    speedX = parseFloat(speedX.toFixed(2))
                }
                if (speedX > -1 && speedX < 0) {
                    speedX += 0.01
                    speedX = parseFloat(speedX.toFixed(2))
                }
                
                if (speedY < 1 && speedY > 0) {
                    speedY -= 0.01
                    speedY = parseFloat(speedY.toFixed(2))
                }
                if (speedY > -1 && speedY < 0) {
                    speedY += 0.01
                    speedY = parseFloat(speedY.toFixed(2))
                }
                if(speedX == 0 && speedY == 0){
                    
                    clearInterval(slowToHalt)
                }
            }, 100)
        }

        function random(min, max) {
            return (Math.random() * (max - min + 1) + min)
        }
        function random2(min, max) {
            return parseFloat((Math.random() * (max - min + 1) + min).toFixed(2))
        }
    </script>
</body>

</html>